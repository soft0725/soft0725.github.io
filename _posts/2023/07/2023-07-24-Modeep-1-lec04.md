---
title: 모딥 시즌 1 - ML lec 04
date: '2023-07-24 17:21:00 +0900'
categories: [2. Machine Learning & DeepLearning, 2 - 1 모두를 위한 딥러닝 시즌 1 정리]
tags: [모두를 위한 딥러닝 시즌 1]
math: true
---

# lec 04 정리

## 복습해보자  
일단 lec 04 파트를 공부하기전에 어떤 것들을 하였는지 간단하게 복습해보도록 하겠다.  
내가 만들 모델은 Linear regression이라고 가정하고 적어보겠다.  

큰 틀로 나눠보자면 아래와 같을 것이다.

<br>

𝟣. Hypothesis (가설)를 정의한다.

$$H(x) = Wx + b$$  


２. Cost function (비용 함수)을 정의한다.

$$Cost = \frac{1}{n} \sum_{i=1}^{n}(Wx^{(i)} - y^{(i)})^2$$ 

𝟥. Gradient descent algorithm (경사 하강법)으로 cost를 최소화 하는 $W, b$값을 찾는다.

$$W = W - \alpha\frac{\partial}{\partial W}cost(W)$$


<br><br>

## 입력받는 X가 한개가 아니라면? 

지금까지는 training data의 X값은 하나 뿐이였다.  

|X|Y|
|:---:|:---:|
|1|2| 

이런식으로 말이댜.
만약에 위 X가 X1, X2, X3, ... Xn 까지 있다면 어떻게 해야할까? 

방법은 아래와 같이 $H(x) = Wx + b$ 부분을 조금 수정하면 된다.  

$$H(x) = Wx + b$$

$$H(x_1, x_2, x_3) = w_1x_1 + w_2x_2 + w_3x_3 + b$$

와 같이 간단하게 수정할 수 있다.  
그리고 위 $H(x_1, x_2, x_3)$를 Cost function에 적용시키면 다음과 같다.

$$cost(W, b) = \frac{1}{n} \sum_{i=1}^{n}(Wx(x_1^{(i)}, x_2^{(i)}, x_3^{(i)}) - y^{(i)})^2$$ 

<br>

### 문제점 

하지만 위처럼 x의 갯수가 적을때는 간단하게 나타낼 수 있지만 
x의 갯수가 100000개 정도면 어떻게 될까?  
일일이 다 적기에는 너무 힘들고 너무 비효율적이기 때문이다.

그럴때 Matrix (행렬)을 사용할 수 있다.

<br><br>

## Matrix (행렬)

$$w_1x_1 + w_2x_2 + w_3x_3 + ... + w_nx_n$$

행렬은 위와 같은 문제점을 해결 할 수 있다.  

`Dot product`의 원리를 사용하면 되는데, Dot product는 벡터의 곱으로도 불리며 간단하게 계산할 수 있다. 

일단 계산하는 예시를 좀 보여주면 아래와 같다.
$$\begin{bmatrix}1&2\\3&4\\ \end{bmatrix}$$
가 있고 $$\begin{bmatrix}1\\2 \end{bmatrix}$$가 있다고 가정할 때  

Dot product의 계산은   
1 * 1 + 2 * 2 = 5  
3 * 1 + 4 * 2 = 11  
이렇게 계산할 수 있다.

따라서 값은 $$\begin{bmatrix}5\\11 \end{bmatrix}$$ 이 된다.

이제 지저분 했던 $w_1x_1 + w_2x_2 + w_3x_3$를 행렬 형태로 바꿔주면    

$$\begin{pmatrix}x_1&x_2&x_3\\ \end{pmatrix}$$ $$\begin{pmatrix}w_1\\w_2\\w_3 \end{pmatrix}$$ =  $$x_1w_1 + x_2w_2 + x_3w_3$$ 
 
그리고 이것을 $$H(X) = XW$$ 의 형태로 나타내주며, $Wx$와는 다르게 위에 행렬 형태가  $X$부터 시작하였기 때문에 $XW$의 형태로 적어준다.  
또한 지저분 했던 $x_1, w_1$을 깔끔하게 나타낼 수 있다는 큰 장점이 있기에 Matrix를 사용한다.  

<br>

### Instance 

입력받는 $X$가 총 3개인 데이터가 있다고 가정하자.  

|x_1|x_2|x_3|y_1|
|:---:|:---:|:---:|:---:|
|1|2|3|4| 
|10|20|30|40| 
|5|6|7|8| 
|50|60|70|80| 

위 데이터에서 가로로 한 직선을 쭉 긋는다 생각해보자  
예를 들어 1, 2, 3, 4 부분을 하나로 쭉 긋는다고 하면 이 부분이 하나의 instance 가 된다.  
그럼 위 데이터는 총 4개의 instance를 가진다고 할 수 있다.  


자 그러면 instance가 여러 개인 데이터는 또 어떻게 처리해야할까?  
이때도 Matrix를 사용해서 처리할 수 있다.  
진짜 Matrix는 엄청나다. 

$$\begin{pmatrix}x_{11}&x_{12}&x_{13}\\x_{21}&x_{22}&x_{23}\\x_{31}&x_{32}&x_{33} \end{pmatrix}$$ $$\begin{pmatrix}w_1\\w_2\\w_3 \end{pmatrix}$$ = $$\begin{pmatrix}x_{11}w_{1} +&x_{12}w_{2} + &x_{13}w_{3}\\x_{21}w_{1} + &x_{22}w_{2} + &x_{23}w_{3}\\x_{31}w_{1} + &x_{32}w_{2} + &x_{33}w_{3} \end{pmatrix}$$  

이렇게 되면 instance의 수대로  matrix를 만들 수 있기 때문에 엄청나게 좋고, 또한 $W$는 그대로 사용할 수 있기에 이것이 matrix를 사용하는 이유이다.  

<br>

### Matrix의 한 가지 규칙?

matrix에서는 한가지 규칙이 있다.  
Dot product를 할 때, 몇 by 몇인지를 보면 규칙이 보일 것이다. 

$$\begin{pmatrix}x_{11}&x_{12}&x_{13}\\x_{21}&x_{22}&x_{23}\\x_{31}&x_{32}&x_{33} \end{pmatrix}$$ $$\begin{pmatrix}w_1\\w_2\\w_3 \end{pmatrix}$$ = $$\begin{pmatrix}x_{11}w_{1} +&x_{12}w_{2} + &x_{13}w_{3}\\x_{21}w_{1} + &x_{22}w_{2} + &x_{23}w_{3}\\x_{31}w_{1} + &x_{32}w_{2} + &x_{33}w_{3} \end{pmatrix}$$  

이것을 예로 들어보자면 
- 첫 번째 matrix는 [5,3]
- 두 번째는 [3,1] 
- 두 matrix를 dot product한 matrix는 [5,1] 

이것을 하나의 줄로 나열해보면  
- [5,3] x [3,1] = [5,1] 

가 되고 어떤 패턴이 보인다.  
- 첫 번째 matrix의 열 부분과, 두 번째 matrix의 행 부분의 숫자가 서로 같다. 
- 첫 번째 matrix의 행 부분과, 두 번째 matrix의 열 부분의 숫자가 결괏값의 크기와 같다.  

[5,3] x [3,1] = [5,1]  

<img src="/assets/img/Modeep1/tensor shape.png" alt="." width="40%" height="40%">  

이렇게 된다.

<br>

### 규칙으로 문제를 풀어보자
이 방법을 사용해서 한 가지 문제를 맞춰보자.  

만약 [3,2]라는 행렬과 [a,b]가 있을 때 서로 곱한 값이 [3,5]라고 할 때  
행렬 [a,b]는 각각 어떤 값을 가질까?  

[3,2] x [a,b] = [3,5]

일단 위에서 했던 규칙을 가지고 풀어보면  
- 첫 번째 행렬에서의 열은 두 번째 행렬의 행 크기과 같다. -> a = 2
- 서로 곱한 행렬의 크기에서 행은 첫 번째 행렬의 행 크기와 같고, 열은 두 번째 행렬의 열과 같다.  
따라서 -> b = 5


<br><br>

틀린 부분이 있다면 말해주세요... 