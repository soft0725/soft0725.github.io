---
title: Cost function에 대해서 알아보자!
date: 2023-06-16 10:37:00 +0900
categories: [딥러닝 공부, 모두를 위한 딥러닝 1]
tags: [cost function]
---
## Cost function에 대해서 알아보자 

Cost function 데이터에 적합한 가설을 세우기 위해서 필요하다. 
일단 원리를 알기 전에 데이터에 대해서 알아보고 가자 


### 사용할 데이터 

| X | Y | 
|:--:|:--:|
|1 | 1 | 
|2 | 2 | 
| 3 | 3 | 

위 데이터는 좌푯값을 나타내는 데이터이다.   
그러면 (1,1), (2,2), (3,3)이라는 데이터를 가지게 되고 이를 그래프로 그리면 아래와 같을 것이다. 
 
<br>

### 데이터를 그래프로 그린다면 
![데이터를 그래프에 표현](/assets/img/2023-06-16/Costfuncion data grape.png){: width="500" height="500"} 

그래프를 그렸으니 가설을 세워서 적당한 가설을 세워보겠다.   
지금은 아무런 가설이나 세워보겠다.

<br>

### 가설을 세우자 
위 그래프에 아무런 직선을 긋는다. 
난 아무 직선이나 3개를 그었다. 

![3개의 가설](/assets/img/2023-06-16/Costfunction grape.png){: width="500" height="500"} 

위 그래프를 보면 우리가 배웠던 1차원 그래프가 생각날 것이다.   
그래프의 식은 `y = ax + b`와 같고 이때 `a`는 기울기, b는 `y`절편을 나타낼 것이다.    
a는 x증가량 분의 y증가량으로 구할 수 있다.  
만약에 기억이 나지 않는다면 [edwith](https://www.edwith.org/sutudy/joinLectures/16586)를 참고하길 바란다. 

<br>

### Cost의 문제점

그럼 나는 새로운 선을 그어서 그 선을 기준으로 설명하겠다. 

![데이터를 그래프에 표현](/assets/img/2023-06-16/hypothesis.png){: width="500" height="500"} 

위 그림에서 파란색 그래프와 빨간색 선은 데이터와 가설의 차이를 보여주는데  
이때 사용하는 것이 `Cost function`이다.

Cost function은 빨간색으로 표시된 길이들의 평균값을 0에 가깝게 만드는 것을 목표로 한다.
그러면 식은 아래와 같을 것이다. 

`(H(x) - y)`

근데 이상한 점이있다.   
그건 `H(x) < y` 일때 음수가 된다는 점인데 길이는 음수가 될 수 없다.
그래서 이 문제는 제곱으로 해결할 수 있다.  
`(H(x) - y)^2)`  이것처럼 말이다. 

제곱을 하면 좋은점이 있다. 
- 길이가 크면 클수록 0에서 멀어지기 때문에 `패널티가 크다`
- 모든 수가 양수가 된다. 

<br>

### Cost 문제점을 보완한 Cost 
그럼 이제 이 Cost의 식을 가지고 위 그림의 빨간색 길이 평균값을 구해보겠다. 
![식](/assets/img/2023-06-16/CodeCogsEqn (1).png){: width="500" height="500"} 

자 근데 여기서 또 문제점이 있다. 
위 식에서 첫 번째 데이터를 1로 봤을 때 총 3개이기 때문에 1 ~ 3까지를 식에서 계산하였다.   
하지만 데이터가 10000... 개가 된다면 식을 어떻게 세울것인가?? 
그럼 아래처럼 시그마를 활용해서 나타낸다. 

![식](/assets/img/2023-06-16/CodeCogsEqn.png){: width="500" height="500"}     

그리고 저 식에 `H(x) = ax + b` 부분에 `H(x)`를 위 식에 대입하면 사진으로 표시된 cost는 `cost(a, b)로 a와 b에 대한 cost를 구하게 된다. `

또한 이것을 
minimize cost(a, b)로 나타내고, 
이는 a와 b가 최대한 작은 값을 갖도록 하는 값을 찾는 것을 의미한다.

<br>

### 마지막으로
<b>다음 포스팅에서는 cost funcion을 python으로 구현해보도록 하겠다.<b>